<div class="hero-container" [class.loading]="loading()">
    @if (loading()) {
    <div class="loader-overlay">
        <mat-spinner diameter="50" color="warn"></mat-spinner>
    </div>
    } @else if (products().length > 0) {
    <div class="hero-section-wrapper">
        <div class="container py-4">
            <div class="row g-4">
                <!-- Main Slider (Flex width) -->
                <div class="col-12 mb-3 mb-lg-0" [ngClass]="flashDeals().length > 0 ? 'col-lg-8' : 'col-lg-12'"
                    *ngIf="products().length > 0">
                    <div class="hero-main shadow-lg">
                        <div class="slider-box" *ngFor="let product of products(); let i = index"
                            [hidden]="currentIndex() !== i">
                            <div class="slide-item">
                                <div class="hero-content">
                                    <div class="glass-container">
                                        <span class="category-tag">EXCLUSIVE</span>
                                        <h1 class="product-title">{{product.name}}</h1>
                                        <div class="price-badge">
                                            <span class="label">Starting at</span>
                                            <span class="amount">â‚¹{{product.price}}</span>
                                        </div>
                                        <button mat-flat-button class="shop-btn"
                                            [routerLink]="['/product', product.modelNo]">
                                            <span class="desktop-text">SHOP THE COLLECTION</span>
                                            <span class="mobile-text">SHOP NOW</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="hero-image-wrapper">
                                    <img [src]="product.variants?.[0]?.images?.[0]?.id ? environment.apiUrl + '/images/' + product.variants[0].images[0].id : environment.apiUrl + '/images/product/' + product.modelNo + '/1'"
                                        [alt]="product.name" class="hero-image"
                                        (error)="$event.target.src='https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=800'">
                                    <div class="image-reflection"></div>
                                </div>
                            </div>
                        </div>

                        <div class="pagination-dots">
                            <span class="dot" *ngFor="let p of products(); let i = index"
                                [class.active]="currentIndex() === i" (click)="setIndex(i)"></span>
                        </div>
                    </div>
                </div>

                <!-- Side Banner Slider (20%) -->
                <div class="col-12 col-lg-4" *ngIf="activeSideProduct as deal">
                    <div class="side-banner-premium shadow-lg" (click)="handleShopNow(deal)" style="cursor: pointer;"
                        [style.backgroundImage]="'url(' + getBannerImage(deal) + ')'">
                        <div class="banner-overlay"></div>
                        <div class="banner-content">
                            <div class="top-info">
                                <span class="badge-premium">{{isFlashSale(deal) ? 'FLASH SALE' : 'FEATURED'}}</span>
                                <h3 class="banner-title text-truncate">{{deal.name}}</h3>
                                <p class="banner-subtitle">{{isFlashSale(deal) ? 'Special offer on ' : 'From
                                    '}}{{deal.brandName}}</p>
                            </div>

                            <div class="offer-box" *ngIf="getDiscount(deal) > 0">
                                <span class="upto">UP TO</span>
                                <span class="discount">{{getDiscount(deal)}}% OFF</span>
                            </div>

                            <div class="side-image-container">
                                <img [src]="getBannerImage(deal)" class="banner-img" [alt]="deal.name">
                            </div>

                            <button class="explore-btn" (click)="$event.stopPropagation(); handleShopNow(deal)">
                                SHOP THE DEAL
                                <mat-icon>trending_flat</mat-icon>
                            </button>

                            <!-- Side Slider Pagination -->
                            <div class="side-pagination" *ngIf="flashDeals().length > 1">
                                <span class="mini-dot" *ngFor="let p of flashDeals(); let i = index"
                                    [class.active]="sideIndex() === i"
                                    (click)="$event.stopPropagation(); setSideIndex(i)"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    }
</div>